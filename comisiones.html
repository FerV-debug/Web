<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comisiones - Children of Anima</title>
  <link rel="stylesheet" href="estilos.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

<div class="site-container">
    <header class="site-header">
  <nav class="menu">
    
    <a href="index.html" class="logo-link">
      <img src="/imagenes/ico2.png" alt="Logo" class="logo-img" onerror="this.src='imagenes/ico2.png'; this.onerror=null;"/>
    </a>

    
    <div class="menu-title-container">
        <img src="/imagenes/titulo.png" alt="Título del juego" class="menu-title-image" onerror="this.src='imagenes/titulo1.png'; this.onerror=null;">
    </div>

    
    <ul>
      <li><a href="home.html">Inicio</a></li>
      <li><a href="galeria.html">Galería</a></li>
      <li><a href="blog.html">Diario</a></li>
      <li><a href="comisiones.html">Comisiones</a></li>
      <li><a href="contacto.html">Contacto</a></li>
    </ul>
  </nav>
</header>

    <main class="content">
      <h2 class="section-title">¡Ten tu propio personaje en el juego!</h2>

      
      <div class="gallery-wrapper">
        <button class="scroll-btn left">‹</button>
        <div class="commission-gallery" id="carousel">
            
            <div class="card">
              <img src="/imagenes/comision1.gif" alt="Comisión 1" onerror="this.src='imagenes/comision1.gif'; this.onerror=null;">
            </div>
            <div class="card">
              <img src="/imagenes/comision2.gif" alt="Comisión 2" onerror="this.src='imagenes/comision2.gif'; this.onerror=null;">
            </div>
            <div class="card">
              <img src="/imagenes/comision3.gif" alt="Comisión 3" onerror="this.src='imagenes/comision3.gif'; this.onerror=null;">
            </div>
            <div class="card">
              <img src="/imagenes/comision4.gif" alt="Comisión 4" onerror="this.src='imagenes/comision4.gif'; this.onerror=null;">
            </div>
            <div class="card">
              <img src="/imagenes/comision5.gif" alt="Comisión 5" onerror="this.src='imagenes/comision5.gif'; this.onerror=null;">
            </div>
            <div class="card">
              <img src="/imagenes/comision6.gif" alt="Comisión 6" onerror="this.src='imagenes/comision6.gif'; this.onerror=null;">
            </div>
            <div class="card">
              <img src="/imagenes/comision7.gif" alt="Comisión 7" onerror="this.src='imagenes/comision7.gif'; this.onerror=null;">
            </div>
             <div class="card">
              <img src="/imagenes/comision8.gif" alt="Comisión 8" onerror="this.src='imagenes/comision8.gif'; this.onerror=null;">
            </div>
             <div class="card">
              <img src="/imagenes/comision9.gif" alt="Comisión 9" onerror="this.src='imagenes/comision9.gif'; this.onerror=null;">
            </div>
             <div class="card">
              <img src="/imagenes/comision10.gif" alt="Comisión 10" onerror="this.src='imagenes/comision10.gif'; this.onerror=null;">
            </div>
        </div>
        <button class="scroll-btn right">›</button>
      </div>


      <div class="card-style" style="max-width: 800px; margin: 40px auto; text-align: center;">
        <p>Para ayudar al desarrollo del juego tienes la oportunidad de encargarme un personaje, ya sea inspirado en ti o en una idea tuya. El personaje tendrá el nombre y aspecto que desees y formará parte del juego, aunque la importancia que quieras que tenga en el juego y su historia depende de ti al elegir la comisión.</p>
        <p>Esto me ayuda a seguir adelante con el desarrollo e invertir lo ganado en mejorar el juego y la experiencia de los usuarios.</p>
        <a href="https://ko-fi.com/imvermilion/commissions" target="_blank" class="enter-button" style="margin-top: 20px; font-size: 1.2rem;">¡Pide tu personaje!</a>
      </div>
      
      
      <h2 class="section-title">Crea tu Personaje</h2>
      <div class="customizer-container card-style">
         
          <div id="character-container">
            
            <img id="base-layer" src="/assets/base.png" alt="Base" onerror="this.src='assets/base.png'; this.onerror=null;">
            <img id="hair-layer" src="/assets/pelo-rojo.png" alt="Pelo" onerror="this.src='assets/pelo-rojo.png'; this.onerror=null;">
            <img id="clothes-layer" src="/assets/ropa1.png" alt="Ropa" onerror="this.src='assets/ropa1.png'; this.onerror=null;">
          </div>
        
          
          <div class="options-panel">
            <div>
              <label for="hair-selector">Pelo:</label>
              <select id="hair-selector" class="select-custom">
                <option value="pelo-rojo.png">Rojo</option>
                <option value="pelo-negro.png">Negro</option>
                <option value="pelo-marron.png">Castaño</option>
                <option value="pelo-rubio.png">Rubio</option>
              </select>
            </div>
            <div>
              <label for="clothes-selector">Ropa:</label>
              <select id="clothes-selector" class="select-custom">
                <option value="ropa1.png">Aventurero</option>
                <option value="ropa2.png">Mago</option>
              </select>
            </div>
            
            <button id="save-btn" class="enter-button" style="font-size: 1rem; padding: 10px 20px;">Guardar Imagen</button>
          </div>
      </div>

    </main>

    <footer class="pie">
      <p>© 2025 Vermilion Games™ | Todos los derechos reservados</p>
    </footer>
</div>


<script>
  
  const carousel = document.getElementById('carousel');
  if (carousel) {
    const btnLeft = document.querySelector('.scroll-btn.left');
    const btnRight = document.querySelector('.scroll-btn.right');
    const cardWidth = 250; 

    btnLeft.addEventListener('click', () => {
      carousel.scrollBy({ left: -cardWidth, behavior: 'smooth' });
    });

    btnRight.addEventListener('click', () => {
      carousel.scrollBy({ left: cardWidth, behavior: 'smooth' });
    });
  }

  
  const hairSelector = document.getElementById("hair-selector");
  const clothesSelector = document.getElementById("clothes-selector");
  const saveBtn = document.getElementById('save-btn');

  if (hairSelector && clothesSelector && saveBtn) {
    const assetPath = 'assets/'; 
    const hairLayer = document.getElementById("hair-layer");
    const clothesLayer = document.getElementById("clothes-layer");
    const baseLayer = document.getElementById("base-layer");


    hairSelector.addEventListener("change", function(e) {
      hairLayer.src = assetPath + e.target.value;
    });

    clothesSelector.addEventListener("change", function(e) {
      clothesLayer.src = assetPath + e.target.value;
    });

    saveBtn.addEventListener('click', () => {
        const canvas = document.createElement('canvas');
        const size = 64; 
        canvas.width = size;
        canvas.height = size;
        const ctx = canvas.getContext('2d');
        ctx.imageSmoothingEnabled = false; 

        
        const layersToDraw = [baseLayer, clothesLayer, hairLayer];
        
        
        const promises = layersToDraw.map(imgElement => {
            return new Promise((resolve, reject) => {
                if (imgElement.complete) {
                    resolve(imgElement);
                } else {
                    const img = new Image();
                    img.crossOrigin = "Anonymous";
                    img.onload = () => resolve(img);
                    img.onerror = reject;
                    img.src = imgElement.src;
                }
            });
        });

        Promise.all(promises)
            .then(images => {
                
                ctx.clearRect(0, 0, size, size);
                images.forEach(img => {
                    ctx.drawImage(img, 0, 0, size, size);
                });
                
                const link = document.createElement('a');
                link.download = 'mi_personaje.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            })
            .catch(error => {
                console.error("Error al cargar las imágenes para el canvas:", error);
                alert("Hubo un error al generar la imagen. Asegúrate de que los archivos existen.");
            });
    });
  }
</script>

</body>
</html>
